; I'll use Form for the type of kinds-of-paperwork, and CS for the type of company states
; Let src (source) be the current CS, and dest (destination) the desired CS.
; From just src and dest, we will extract a finite set of Primitive Values, each of which belongs to a unique Sort.

(Sorts
	ShareQuantity
	MoneyAmount

	Party
	PartyName
	PartyIdType
	PartyIdNum
	EntityNature
	Gender

	Company
	CompanyName
	Jurisdiction
	CompanyAddress
	CompanyIdType
	CompanyIdNum
	Constitution ; let's just treat this as a single string for now, just because it's a convenient simplification that doesn't affect anything else.

	Security
	SecurityName
	SecurityMeasure
	SecurityUnits

	Contract
	ContractSignDate
	ContractTitle

	CompanyState

	Holding

	HeldSecurity
	HeldSecurityDescription
)

(DataTypes
	(Party
		PartyName ; implicit field name "partyname"
		PartyIdType ; "partyidtype"
		PartyIdNum
		EntityNature
		Gender
	)

	(Company
		(asParty Party) ; we're not using subtyping, so this is the Party version of the Company
		CompanyName
		Jurisdiction
		CompanyAddress
		CompanyIdType
		CompanyIdNum
		Constitution ; treating this as a single string for now
		(directors Party ≥1)
		(secretary Party)
	)

	(Security
		SecurityName
		SecurityMeasure
	)

	(Holding
		PartyName
		(holds HeldSecurity ≥0)
	)

	(HeldSecurity
		Security
		(units SecurityUnits 0-1)
		(money_spent MoneyAmount 0-1)
		(description HeldSecurityDescription 0-1)
	)

	(Contract
		ContractTitle
		ContractSignDate
		(parties Party ≥2)
	)

	(CompanyState
		Company
		(parties Party ≥1)
		(securities Security ≥1)
		(holdings Holding ≥0)
		(agreements Contract ≥0)
	)
)

(Constants
	(#byUnit #byMoney 		SecurityMeasure)

	(#human #corporate #ai  EntityNature)

	(#male #female #neutral Gender)

	(#company 				Company)
)


; Nothing else at the moment
; (OtherPredicates
; )


; for actions we go a little informal
;


(Actions
	(addExistingInvestor
		; challenge for planning languages: this should add the investor with all of their current holdings, in one go (I think).

	)
	(newSAFE
		; to add a new SAFE:
		; 1. do a directors resolution
		; 2. wait for shareholder approval... or wait for X days and treat no answer as approval?
		; 3. notify each SAFE investor who has a right to buy new shares on the current contract's terms.
			; 3a. treat no answer within T days as declining
		; 4. sign the new SAFE
		(Parameters (investor Party))
		(OptionalParameters)
		(Preconditions
			(not (#company.parties investor))
		)
		(Subactions
			(signShareHoldersAgreement investor)
			; ((proRataRights p) foreach Party p (suchthat ))
		)
		(Effects
			(#company.parties investor)
		)
	)

)

;